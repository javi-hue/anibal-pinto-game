<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Telegramas Urgentes ‚Äî Gobierno de An√≠bal Pinto</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#f59e0b; --muted:#94a3b8; --good:#16a34a; --bad:#ef4444;
    }
    *{box-sizing:border-box;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial}
    body{margin:0;background:linear-gradient(180deg,#071122 0%, #0b1220 100%);color:#e6eef8;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px}
    .container{width:980px;max-width:100%;display:grid;grid-template-columns:1fr 360px;gap:20px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.04);padding:18px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.7)}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    header h1{font-size:18px;margin:0}
    header p{margin:0;color:var(--muted);font-size:13px}
    .tele{min-height:140px;padding:14px;border-radius:10px;background:rgba(255,255,255,0.02);margin-bottom:12px}
    .tele .meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
    .tele .meta .badge{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px;font-size:13px}
    .tele p{margin:6px 0 0;font-size:15px;line-height:1.35}

    .options{display:flex;flex-direction:column;gap:8px}
    .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 12px;border-radius:10px;text-align:left;cursor:pointer;font-size:14px}
    .btn:hover{border-color:rgba(255,255,255,0.12)}
    .btn:active{transform:translateY(1px)}

    .status{display:flex;flex-direction:column;gap:12px}
    .stat-row{display:flex;align-items:center;justify-content:space-between}
    .bars{display:flex;gap:10px;flex-direction:column}
    .bar{background:rgba(255,255,255,0.04);height:12px;border-radius:999px;overflow:hidden}
    .bar > span{display:block;height:100%;width:50%;background:linear-gradient(90deg,var(--accent),#f97316)}
    .bar.econ > span{background:linear-gradient(90deg,#f59e0b,#fb923c)}
    .bar.pop > span{background:linear-gradient(90deg,#06b6d4,#0ea5a4)}
    .bar.mil > span{background:linear-gradient(90deg,#ef4444,#f97316)}
    .bar.dev > span{background:linear-gradient(90deg,#84cc16,#22c55e)}

    .right-panel{display:flex;flex-direction:column;gap:12px}
    .small{font-size:13px;color:var(--muted)}
    .timer{width:120px;height:120px;border-radius:999px;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:700;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.04)}
    .progress{height:10px;background:rgba(255,255,255,0.03);border-radius:999px;overflow:hidden}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#f97316);width:100%}

    .footer{display:flex;align-items:center;justify-content:space-between;margin-top:10px;color:var(--muted);font-size:13px}
    .chip{background:rgba(255,255,255,0.02);padding:6px 10px;border-radius:999px}

    .end-screen{padding:24px;text-align:center}
    .hidden{display:none}
    .year{font-weight:700;color:var(--accent)}
    @media(max-width:880px){.container{grid-template-columns:1fr;}.right-panel{order:-1}}
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <header>
        <h1>Telegramas Urgentes ‚Äî Gobierno de An√≠bal Pinto</h1>
        <p class="small">20 decisiones ‚Ä¢ 20 segundos cada una ‚Ä¢ Partida ~5-6 min</p>
      </header>

      <div id="tele" class="tele">
        <div class="meta"><div class="badge" id="turnInfo">Turno 1 ‚Ä¢ 1876</div><div class="small" id="yearLabel">A√±o: 1876</div></div>
        <p id="teleText">Pulsa "Comenzar" para recibir el primer telegrama.</p>
      </div>

      <div class="options" id="optionsArea">
        <button class="btn" id="startBtn">‚ñ∂Ô∏è Comenzar partida</button>
      </div>

      <div class="footer">
        <div class="chip" id="hint">Consejeros disponibles: 3</div>
        <div class="small">Dise√±ado para partidas r√°pidas y rejugables</div>
      </div>
    </div>

    <aside class="card right-panel">
      <div class="status">
        <div class="stat-row"><div class="small">Econom√≠a</div><div id="econVal">50</div></div>
        <div class="bar econ"><span id="econBar" style="width:50%"></span></div>

        <div class="stat-row"><div class="small">Popularidad</div><div id="popVal">50</div></div>
        <div class="bar pop"><span id="popBar" style="width:50%"></span></div>

        <div class="stat-row"><div class="small">Fuerzas Armadas</div><div id="milVal">50</div></div>
        <div class="bar mil"><span id="milBar" style="width:50%"></span></div>

        <div class="stat-row"><div class="small">Desarrollo (educ./leyes)</div><div id="devVal">50</div></div>
        <div class="bar dev"><span id="devBar" style="width:50%"></span></div>
      </div>

      <div style="display:flex;gap:12px;margin-top:14px;align-items:center;">
        <div class="timer" id="timer">20</div>
        <div style="flex:1">
          <div class="small">Tiempo restante</div>
          <div class="progress" style="margin-top:8px"><i id="progressInner" style="width:100%"></i></div>
          <div style="height:6px"></div>
          <div class="small">Decisi√≥n <span id="turnCounter">0</span>/20</div>
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="small">Registro r√°pido</div>
        <div id="log" style="height:120px;overflow:auto;margin-top:8px;padding:8px;background:rgba(255,255,255,0.02);border-radius:8px;font-size:13px;color:var(--muted)"></div>
      </div>

    </aside>
  </div>

  <!-- End screen modal (simple) -->
  <div id="endModal" class="card hidden" style="position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:720px;max-width:95%;z-index:50">
    <div class="end-screen">
      <h2 id="endTitle">Resultado</h2>
      <p id="endText" style="color:var(--muted)"></p>
      <div style="display:flex;gap:10px;justify-content:center;margin-top:14px">
        <button class="btn" id="restartBtn">üîÅ Jugar otra vez</button>
        <button class="btn" id="exportBtn">üìÑ Exportar resumen (texto)</button>
      </div>
      <pre id="exportArea" style="text-align:left;background:#021020;color:#cfeff8;padding:12px;border-radius:8px;margin-top:12px;display:none;overflow:auto;max-height:240px"></pre>
    </div>
  </div>

  <script>
    // Datos del juego: 20 telegramas que cubren 1876-1881
    const events = [
      {year:1876, short:'Ca√≠da de precios del salitre. Se necesita ajuste presupuestario.',
        opts:[
          {t:'Recortar gasto p√∫blico', effects:{econ:10,pop:-8,mil:-5,dev:-4}},
          {t:'Aumentar impuestos', effects:{econ:7,pop:-10,mil:0,dev:0}},
          {t:'Pedir pr√©stamo externo', effects:{econ:12,pop:-4,mil:0,dev:-6}}
        ]},
      {year:1876, short:'Propuesta para crear escuelas rurales en provincias.',
        opts:[
          {t:'Financiarlas con fondos p√∫blicos', effects:{econ:-8,pop:6,mil:0,dev:10}},
          {t:'Postergar por la crisis', effects:{econ:4,pop:-5,mil:0,dev:-6}},
          {t:'Buscar aportes privados', effects:{econ:0,pop:-2,mil:0,dev:6}}
        ]},
      {year:1877, short:'Huelga en salitreras exige mejores condiciones laborales.',
        opts:[
          {t:'Apoyar regulaci√≥n laboral', effects:{econ:-6,pop:8,mil:0,dev:6}},
          {t:'Reprimir la huelga', effects:{econ:4,pop:-10,mil:6,dev:-4}},
          {t:'Negociar mediaci√≥n', effects:{econ:0,pop:4,mil:0,dev:2}}
        ]},
      {year:1877, short:'Iniciativa para modernizar la red telegr√°fica.',
        opts:[
          {t:'Aprobar proyecto', effects:{econ:-5,pop:3,mil:2,dev:8}},
          {t:'Limitar inversi√≥n', effects:{econ:6,pop:-2,mil:0,dev:-4}},
          {t:'Concesi√≥n a privados', effects:{econ:0,pop:-1,mil:0,dev:5}}
        ]},
      {year:1878, short:'Tensi√≥n con Bolivia por l√≠mites y derechos comerciales.',
        opts:[
          {t:'Diplomacia activa', effects:{econ:0,pop:2,mil:-3,dev:0}},
          {t:'Movilizar tropas en frontera', effects:{econ:-6,pop:-3,mil:8,dev:0}},
          {t:'Buscar mediaci√≥n internacional', effects:{econ:-2,pop:1,mil:-2,dev:0}}
        ]},
      {year:1878, short:'Proyecto de ley para regular jornada en salitreras.',
        opts:[
          {t:'Apoyar la ley', effects:{econ:-5,pop:6,mil:0,dev:5}},
          {t:'Vetar por presi√≥n empresarial', effects:{econ:6,pop:-8,mil:0,dev:-3}},
          {t:'Modificar y aprobar', effects:{econ:-2,pop:2,mil:0,dev:2}}
        ]},
      {year:1879, short:'El Hu√°scar ataca convoyes: alarma naval en el norte.',
        opts:[
          {t:'Enviar fragatas a interceptar', effects:{econ:-8,pop:5,mil:10,dev:0}},
          {t:'Esperar refuerzos', effects:{econ:4,pop:-2,mil:-4,dev:0}},
          {t:'Negociar prisa diplom√°tica', effects:{econ:0,pop:-1,mil:-3,dev:0}}
        ]},
      {year:1879, short:'Necesidad de carb√≥n para la flota. Propuesta de compra urgente.',
        opts:[
          {t:'Comprar carb√≥n inmediato', effects:{econ:-7,pop:3,mil:8,dev:0}},
          {t:'Racionar recursos', effects:{econ:3,pop:-4,mil:-6,dev:0}},
          {t:'Solicitar ayuda privada', effects:{econ:0,pop:-2,mil:4,dev:-1}}
        ]},
      {year:1879, short:'Petici√≥n para destinar m√°s fondos a hospitales militares.',
        opts:[
          {t:'Aumentar fondos', effects:{econ:-5,pop:4,mil:6,dev:2}},
          {t:'Mantener presupuesto', effects:{econ:2,pop:-2,mil:-3,dev:0}},
          {t:'Gestionar ayuda extranjera', effects:{econ:0,pop:1,mil:2,dev:0}}
        ]},
      {year:1880, short:'Propuesta de ferrocarril para mejorar el transporte de salitre.',
        opts:[
          {t:'Iniciar obra p√∫blica', effects:{econ:-10,pop:6,mil:0,dev:10}},
          {t:'Postergar por guerra', effects:{econ:5,pop:-3,mil:0,dev:-6}},
          {t:'Concesi√≥n parcial', effects:{econ:0,pop:0,mil:0,dev:4}}
        ]},
      {year:1880, short:'Demandas por orden p√∫blico en capital: saqueos y protestas.',
        opts:[
          {t:'Reforzar seguridad', effects:{econ:-4,pop:-3,mil:6,dev:0}},
          {t:'Dialogar con l√≠deres civiles', effects:{econ:0,pop:5,mil:-2,dev:2}},
          {t:'Declarar toque de queda', effects:{econ:-2,pop:-6,mil:4,dev:-2}}
        ]},
      {year:1880, short:'Propuesta educativa: enviar becas al extranjero para formaci√≥n docente.',
        opts:[
          {t:'Aprobar becas', effects:{econ:-4,pop:4,mil:0,dev:8}},
          {t:'Priorizar recursos locales', effects:{econ:2,pop:-1,mil:0,dev:2}},
          {t:'Buscar intercambio p√∫blico-privado', effects:{econ:0,pop:0,mil:0,dev:4}}
        ]},
      {year:1880, short:'Crisis de abastecimiento en tropas del norte.',
        opts:[
          {t:'Enviar convoyes de suministro', effects:{econ:-6,pop:2,mil:8,dev:0}},
          {t:'Redistribuir lo disponible', effects:{econ:2,pop:-2,mil:-5,dev:0}},
          {t:'Reforzar log√≠stica por contratos', effects:{econ:-2,pop:0,mil:4,dev:1}}
        ]},
      {year:1881, short:'Negociaciones por final de hostilidades: opciones sobre paz.',
        opts:[
          {t:'Negociar paz con condiciones', effects:{econ:0,pop:3,mil:-5,dev:2}},
          {t:'Continuar ofensiva', effects:{econ:-8,pop:2,mil:9,dev:0}},
          {t:'Buscar mediaci√≥n externa', effects:{econ:-2,pop:0,mil:-2,dev:0}}
        ]},
      {year:1881, short:'Propuesta de reforma judicial y administraci√≥n p√∫blica.',
        opts:[
          {t:'Aprobar reformas', effects:{econ:-4,pop:3,mil:0,dev:8}},
          {t:'Mantener status quo', effects:{econ:3,pop:-2,mil:0,dev:-4}},
          {t:'Aprobar parcialmente', effects:{econ:-1,pop:1,mil:0,dev:3}}
        ]},
      {year:1877, short:'Corrupci√≥n en contratos de obras p√∫blicas denunciada.',
        opts:[
          {t:'Investigar y sancionar', effects:{econ:-3,pop:6,mil:0,dev:2}},
          {t:'Encubrir para no escandalizar', effects:{econ:2,pop:-6,mil:0,dev:-3}},
          {t:'Renegociar contratos', effects:{econ:0,pop:-1,mil:0,dev:1}}
        ]},
      {year:1878, short:'Presi√≥n extranjera por protecci√≥n de inversiones de empresas for√°neas.',
        opts:[
          {t:'Proteger inversiones', effects:{econ:5,pop:-3,mil:0,dev:0}},
          {t:'Priorizar soberan√≠a', effects:{econ:-4,pop:4,mil:0,dev:0}},
          {t:'Negociar compensaciones', effects:{econ:-1,pop:1,mil:0,dev:0}}
        ]},
      {year:1879, short:'Campa√±a publicitaria para aumentar moral y apoyo popular.',
        opts:[
          {t:'Lanzar campa√±a', effects:{econ:-3,pop:8,mil:1,dev:0}},
          {t:'No gastar en propaganda', effects:{econ:3,pop:-4,mil:0,dev:0}},
          {t:'Usar figuras p√∫blicas para apoyo', effects:{econ:0,pop:4,mil:0,dev:0}}
        ]},
      {year:1881, short:'Balance final: ¬øc√≥mo recuerdan tu gobierno?',
        opts:[
          {t:'Priorizar legado social (escuelas, leyes)', effects:{econ:-6,pop:6,mil:-2,dev:12}},
          {t:'Priorizar victoria militar', effects:{econ:-8,pop:3,mil:10,dev:0}},
          {t:'Equilibrio entre gasto y paz', effects:{econ:-3,pop:2,mil:0,dev:4}}
        ]}
    ];

    // Estado del juego
    let state = {econ:50,pop:50,mil:50,dev:50,turn:0,log:[]};
    let timerInterval=null,remaining=20,maxTurns=20;

    // DOM refs
    const teleText = document.getElementById('teleText');
    const optionsArea = document.getElementById('optionsArea');
    const timerEl = document.getElementById('timer');
    const turnCounter = document.getElementById('turnCounter');
    const turnInfo = document.getElementById('turnInfo');
    const yearLabel = document.getElementById('yearLabel');
    const econBar = document.getElementById('econBar');
    const popBar = document.getElementById('popBar');
    const milBar = document.getElementById('milBar');
    const devBar = document.getElementById('devBar');
    const econVal = document.getElementById('econVal');
    const popVal = document.getElementById('popVal');
    const milVal = document.getElementById('milVal');
    const devVal = document.getElementById('devVal');
    const progressInner = document.getElementById('progressInner');
    const logEl = document.getElementById('log');
    const endModal = document.getElementById('endModal');
    const endTitle = document.getElementById('endTitle');
    const endText = document.getElementById('endText');
    const exportArea = document.getElementById('exportArea');

    function startGame(){
      state = {econ:50,pop:50,mil:50,dev:50,turn:0,log:[]};
      remaining=20; clearInterval(timerInterval);
      document.getElementById('startBtn').classList.add('hidden');
      endModal.classList.add('hidden');
      nextTurn();
    }

    function nextTurn(){
      if(state.turn>=maxTurns){ finishGame(); return; }
      const ev = events[state.turn % events.length]; // sequential covering
      state.turn++;
      turnCounter.textContent = state.turn;
      turnInfo.textContent = `Decisi√≥n ${state.turn} ‚Ä¢ ${ev.year}`;
      yearLabel.textContent = `A√±o: ${ev.year}`;
      teleText.textContent = ev.short;
      renderOptions(ev);
      startTimer();
    }

    function renderOptions(ev){
      optionsArea.innerHTML='';
      ev.opts.forEach((opt,i)=>{
        const btn = document.createElement('button');
        btn.className='btn';
        btn.innerHTML = `<strong>${String.fromCharCode(65+i)}.</strong> ${opt.t}`;
        btn.onclick = ()=>chooseOption(i);
        optionsArea.appendChild(btn);
      });
    }

    function startTimer(){
      clearInterval(timerInterval);
      remaining=20; updateTimerUI();
      timerInterval = setInterval(()=>{
        remaining--;
        if(remaining<=0){
          clearInterval(timerInterval);
          // auto-pick middle option (index 1) if exists
          const ev = events[state.turn-1];
          const pick = Math.min(1, ev.opts.length-1);
          chooseOption(pick,true);
          return;
        }
        updateTimerUI();
      },1000);
    }

    function updateTimerUI(){
      timerEl.textContent = remaining;
      const pct = (remaining/20)*100;
      progressInner.style.width = pct + '%';
    }

    function clamp(v){ return Math.max(0, Math.min(100, v)); }

    function chooseOption(index,auto=false){
      clearInterval(timerInterval);
      const ev = events[state.turn-1];
      const opt = ev.opts[index];
      // aplicar efectos
      state.econ = clamp(state.econ + opt.effects.econ);
      state.pop = clamp(state.pop + opt.effects.pop);
      state.mil = clamp(state.mil + opt.effects.mil);
      state.dev = clamp(state.dev + opt.effects.dev);
      // registrar
      const note = `${ev.year}: ${ev.short} ‚Üí ${String.fromCharCode(65+index)}. ${opt.t} ${auto? '(auto)': ''}`;
      state.log.push(note);
      renderStats();
      appendLog(note);

      // breve animaci√≥n y siguiente
      optionsArea.innerHTML = '<div class="small">Procesando decisi√≥n...</div>';
      setTimeout(()=>{
        // Chequear condiciones de terminaci√≥n
        if(state.econ<=0 || state.pop<=0 || state.mil<=0){
          finishGame('colapso');
          return;
        }
        nextTurn();
      },600);
    }

    function renderStats(){
      econBar.style.width = state.econ + '%'; econVal.textContent = state.econ;
      popBar.style.width = state.pop + '%'; popVal.textContent = state.pop;
      milBar.style.width = state.mil + '%'; milVal.textContent = state.mil;
      devBar.style.width = state.dev + '%'; devVal.textContent = state.dev;
    }

    function appendLog(text){
      const el = document.createElement('div'); el.textContent = text; logEl.prepend(el);
      if(logEl.childElementCount>40) logEl.removeChild(logEl.lastChild);
    }

    function finishGame(reason){
      clearInterval(timerInterval);
      endModal.classList.remove('hidden');
      // evaluar resultado
      const score = state.econ + state.pop + state.mil + state.dev;
      let title='Resultado'; let text='';
      if(reason==='colapso'){
        title='Colapso pol√≠tico o militar';
        text='Alguna barra lleg√≥ a 0 antes de completar el mandato. El pa√≠s entra en crisis y tu gobierno termina abruptamente.';
      } else if(score>=300){
        title='Legado destacado';
        text='Has mantenido un equilibrio excelente: econom√≠a, defensa y desarrollo. Tu mandato pasa a la historia con buenos balances.';
      } else if(state.mil>=80){
        title='Victoria militar con costos';
        text='Se logr√≥ ventaja militar, pero otros indicadores muestran tensiones internas y costos econ√≥micos.';
      } else if(state.econ<=30){
        title='Crisis econ√≥mica persistente';
        text='La econom√≠a queda debilitada; aunque puedas haber logrado otras metas, el pa√≠s sufre.';
      } else {
        title='Mandato mixto';
        text='Decisiones con resultados variados: aciertos y errores, un legado equilibrado pero con sombras.';
      }
      endTitle.textContent = title;
      endText.textContent = text + '\n\nResumen r√°pido:';
      exportArea.style.display='none';
      // construir resumen
      let summary = `Resumen de la partida:\n`;
      summary += `Indicadores finales ‚Äî Econom√≠a: ${state.econ}, Popularidad: ${state.pop}, Fuerzas Armadas: ${state.mil}, Desarrollo: ${state.dev}\n\n`;
      summary += state.log.slice().reverse().map((s,i)=>`${i+1}. ${s}`).join('\n');
      exportArea.textContent = summary;
    }

    // botones
    document.getElementById('startBtn').addEventListener('click', startGame);
    document.getElementById('restartBtn').addEventListener('click', ()=>{ endModal.classList.add('hidden'); startGame(); });
    document.getElementById('exportBtn').addEventListener('click', ()=>{ exportArea.style.display = exportArea.style.display==='none'? 'block':'none'; });

    // iniciar mostrando estad√≠stica inicial
    renderStats();

  </script>
</body>
</html>
